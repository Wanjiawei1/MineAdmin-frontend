import{d as x,p as D}from"./role-2UO_91S_.js";import M from"./getSearchItems-B6LQ1y-3.js";import O from"./getTableColumns-DPS0m-IZ.js";import{u as U}from"./useDialog-o5jPWvsH.js";import{u as w}from"./useMessage-npDFBwy-.js";import{d as I,r as i,e as b,av as P,f as N,h as c,b as T,aj as m,ag as n,w as g,O as s,z as v,ah as y,aZ as V,b7 as C}from"./index-BsGhlh_X.js";import{_ as W}from"./form.vue_vue_type_script_setup_true_lang-DqPmGwKQ.js";import{_ as $}from"./setPermissionForm.vue_vue_type_script_setup_true_lang-DqTcTGr4.js";import{u as j}from"./useTrans-kmCwB86_.js";import"./ma-dict-select.vue_vue_type_script_setup_true_lang-7zgHWofH.js";import"./__commonjsHelpers__-CqkleIqs.js";import"./index.vue_vue_type_script_setup_true_lang-CGvxUkWP.js";import"./getFormItems-DRUHFn0u.js";import"./ma-dict-radio.vue_vue_type_script_setup_true_lang-CKSXZsZK.js";import"./useForm-Dr9zNnRS.js";import"./index.es-CqsyxuiI.js";import"./index-CzdtxYH6.js";import"./useLocalTrans-APekFW45.js";const q={class:"mine-layout pt-3"},ie=I({name:"permission:role",__name:"index",setup(z){const u=i(),d=i(),f=i(),h=i([]),e=j().globalTrans,o=w(),r=U({lgWidth:"550px",ok:({formType:l},a)=>{a(!0),["add","edit"].includes(l)?d.value.maForm.getElFormRef().validate().then(()=>{switch(l){case"add":d.value.add().then(t=>{t.code===C.SUCCESS?o.success(e("crud.createSuccess")):o.error(t.message),r.close(),u.value.refresh()}).catch(t=>{o.alertError(t)});break;case"edit":d.value.edit().then(t=>{t.code===200?o.success(e("crud.updateSuccess")):o.error(t.message),r.close(),u.value.refresh()}).catch(t=>{o.alertError(t)});break}}).catch():f.value.maForm.getElFormRef().validate().then(()=>{f.value.saveUserRole().then(t=>{t.code===C.SUCCESS?o.success(e("baseUserManage.setRoleSuccess")):o.error(t.message),r.close()}).catch(t=>{o.alertError(t)})}),a(!1)}}),k=i({adaptionOffsetBottom:161,header:{mainTitle:()=>e("baseRoleManage.mainTitle"),subTitle:()=>e("baseRoleManage.subTitle")},tableOptions:{on:{onSelectionChange:l=>h.value=l}},searchOptions:{fold:!0,text:{searchBtn:()=>e("crud.search"),resetBtn:()=>e("crud.reset"),isFoldBtn:()=>e("crud.searchFold"),notFoldBtn:()=>e("crud.searchUnFold")}},searchFormOptions:{labelWidth:"90px"},requestOptions:{api:D}}),R=i({searchItems:M(e),tableColumns:O(r,d,e)});function B(){const l=h.value.map(a=>a.id);o.confirm(e("crud.delMessage")).then(async()=>{(await x(l)).code===C.SUCCESS&&(o.success(e("crud.delSuccess")),u.value.refresh())})}return(l,a)=>{const p=b("el-button"),t=b("el-empty"),E=b("MaProTable"),_=P("auth");return c(),N("div",q,[T(E,{ref_key:"proTableRef",ref:u,options:s(k),schema:s(R)},{actions:n(()=>[g((c(),m(p,{type:"primary",onClick:a[0]||(a[0]=()=>{s(r).setTitle(s(e)("crud.add")),s(r).open({formType:"add"})})},{default:n(()=>[v(y(s(e)("crud.add")),1)]),_:1})),[[_,["permission:role:save"]]])]),toolbarLeft:n(()=>[g((c(),m(p,{type:"danger",plain:"",disabled:s(h).length<1,onClick:B},{default:n(()=>[v(y(s(e)("crud.delete")),1)]),_:1},8,["disabled"])),[[_,["permission:role:delete"]]])]),empty:n(()=>[T(t,null,{default:n(()=>[g((c(),m(p,{type:"primary",onClick:a[1]||(a[1]=()=>{s(r).setTitle(s(e)("crud.add")),s(r).open({formType:"add"})})},{default:n(()=>[v(y(s(e)("crud.add")),1)]),_:1})),[[_,["permission:role:save"]]])]),_:1})]),_:1},8,["options","schema"]),(c(),m(V(s(r).Dialog),null,{default:n(({formType:F,data:S})=>[F!=="setPermission"?(c(),m(W,{key:0,ref_key:"formRef",ref:d,"form-type":F,data:S},null,8,["form-type","data"])):(c(),m($,{key:1,ref_key:"setFormRef",ref:f,data:S},null,8,["data"]))]),_:1}))])}}});export{ie as default};
