import{d as le,am as se,r as W,an as Xe,aj as T,h as y,b as ue,ao as Ge,ak as Qe,ag as he,ap as _,aq as it,ar as ct,O as u,S as qe,i as j,c as We,o as xe,n as oe,a as ke,as as z,f as D,ai as ae,j as U,m as He,ah as je,P as Ce,V as Je,e as et,F as ze,T as dt,at as $e,W as Q,X as _e,al as ye}from"./index-fEaXY3hb.js";let ne=null;function ft(){return ne!==null}function vt(e){ne&&tt(),ne=e}function Ee(e){e===ne&&(ne=null)}function tt(){ne&&(ne.closeMenu(),ne=null)}const ee={defaultDirection:"br",defaultMinWidth:100,defaultMaxWidth:600,defaultZindex:100,defaultZoom:1,defaultAdjustPadding:{x:0,y:10}};function me(e,l){let a=e.offsetTop;return e.offsetParent!=null&&e.offsetParent!=l&&(a-=e.offsetParent.scrollTop,a+=me(e.offsetParent,l)),a}function pe(e,l){let a=e.offsetLeft;return e.offsetParent!=null&&e.offsetParent!=l&&(a-=e.offsetParent.scrollLeft,a+=pe(e.offsetParent,l)),a}function ht(e,l,a,r){return{x:pe(e,r)+l,y:me(e,r)+a}}const Ie="mx-menu-default-container",mt="mx-menu-container-";let pt=0;function nt(e){const{getContainer:l,zIndex:a}=e;if(l){const f=typeof l=="function"?l():l;if(f){let t=f.getAttribute("id");return t||(t=mt+pt++,f.setAttribute("id",t)),{eleId:t,container:f,isNew:!1}}}let r=document.getElementById(Ie);return r||(r=document.createElement("div"),r.setAttribute("id",Ie),r.setAttribute("class","mx-menu-ghost-host fullscreen"),document.body.appendChild(r)),r.style.zIndex=(a==null?void 0:a.toString())||ee.defaultZindex.toString(),{eleId:Ie,container:r,isNew:!0}}function gt(e){let l=0;for(let a=0;a<e.length;a++){const r=e.charCodeAt(a);l=(l<<5)-l+r,l|=0}return l}function Ne(e){return typeof e=="number"?`${e}px`:e}const J=le({props:{vnode:{type:null},data:{type:null,default:null}},setup(e){const{vnode:l,data:a}=se(e);return()=>typeof l.value=="function"?l.value(a.value):l.value}});function bt(e,l){const a={...e};return delete a[l],a}var yt=Object.defineProperty,Ct=(e,l,a)=>l in e?yt(e,l,{enumerable:!0,configurable:!0,writable:!0,value:a}):e[l]=a,De=(e,l,a)=>Ct(e,typeof l!="symbol"?l+"":l,a);class Ve{constructor(l,a){De(this,"x",0),De(this,"y",0),this.x=l||0,this.y=a||0}set(l,a){this.x=l,this.y=a}substract(l){this.x-=l.x,this.y-=l.y}}function Ke(e){const{onDown:l,onMove:a,onUp:r}=e,f=new Ve,t=new Ve;let k;function c(h){h.stopPropagation(),t.set(h.x,h.y),t.substract(f),a(f,t,h,k)}function m(h){r(h,k),f.set(0,0),document.removeEventListener("mousemove",c),document.removeEventListener("mouseup",m)}return(h,p)=>l(h,p)?(k=p,f.set(h.x,h.y),document.addEventListener("mousemove",c),document.addEventListener("mouseup",m),h.stopPropagation(),!0):!1}function xt(e,l){let a=0;return{start(){a>0&&clearInterval(a),a=setInterval(()=>{a=0,l()},e)},stop(){a>0&&(clearInterval(a),a=0)}}}const ve=[],Ye=xt(100,()=>{for(const e of ve)e()});function kt(e,l,a,r){let f=0,t=0;function k(){e.value&&(l&&f!==e.value.offsetWidth&&l(e.value.offsetWidth),a&&t!==e.value.offsetHeight&&a(e.value.offsetHeight),f=e.value.offsetWidth,t=e.value.offsetHeight)}return{startResizeChecker(){Ye.start(),ve.push(k)},stopResizeChecker(){const c=ve.indexOf(k);c>=0&&ve.splice(c,1),ve.length===0&&Ye.stop()}}}const Ze=140,Mt=70,St=le({__name:"ScrollRect",props:{scroll:{type:String,default:"both"},scrollBarAlwaysShow:{type:Boolean,default:!1},scrollBarBackgroundClickable:{type:Boolean,default:!1},height:{type:Number,default:void 0},width:{type:Number,default:void 0},maxHeight:{type:Number,default:void 0},maxWidth:{type:Number,default:void 0},containerClass:{type:String,default:""},containerStyle:{type:null}},emits:["scroll","resized"],setup(e,{expose:l,emit:a}){const r=e,f=a,t=W(),k=W(),c=W(),m=W(),h=W(),p=W(),R=W(!1),V=We(()=>r.scroll==="horizontal"||r.scroll==="both"),H=We(()=>r.scroll==="vertical"||r.scroll==="both"),C=_e({show:!1,size:0,sizeRaw:0,pos:0}),x=_e({show:!1,size:0,sizeRaw:0,pos:0});let M=0,g=0,O=0,B=0,P=null;const S={attributes:!0,childList:!0};function i(){if(t.value){if(C.show){const n=t.value.offsetWidth/t.value.scrollWidth;C.sizeRaw=n*t.value.offsetWidth,C.size=n*100,C.pos=t.value.scrollLeft/(t.value.scrollWidth-t.value.offsetWidth)*(100-C.size),n>=1&&(C.show=!1)}if(x.show){const n=t.value.offsetHeight/t.value.scrollHeight;x.sizeRaw=n*t.value.offsetHeight,x.size=n*100,x.pos=t.value.scrollTop/(t.value.scrollHeight-t.value.offsetHeight)*(100-x.size),n>=1&&(x.show=!1)}f("scroll",t.value.scrollLeft,t.value.scrollTop)}}function v(n=!1){if(!t.value)return;let d=V.value,o=H.value;const ie=d&&(M!==t.value.scrollWidth||O!==t.value.offsetWidth),Z=H&&(g!==t.value.scrollHeight||B!==t.value.offsetHeight);if(!n&&!ie&&!Z)return;const F=window.getComputedStyle(t.value);(F.overflow==="hidden"||F.overflowX==="hidden")&&(d=!1),(F.overflow==="hidden"||F.overflowY==="hidden")&&(o=!1),C.show=d,x.show=o,i(),O=t.value.offsetWidth,B=t.value.offsetHeight,M=t.value.scrollWidth,g=t.value.scrollHeight,f("resized",M,g)}function E(n){var d;r.scroll=="horizontal"&&(n.deltaMode==0&&((d=t.value)==null||d.scrollTo({left:t.value.scrollLeft+(n.deltaY>0?Ze:-140),behavior:"smooth"})),n.preventDefault(),n.stopPropagation())}function w(n){var d;n.deltaMode==0&&((d=t.value)==null||d.scrollTo({left:t.value.scrollLeft+(n.deltaY>0?Ze:-140),behavior:"smooth"}),n.preventDefault(),n.stopPropagation())}function $(n){var d;n.deltaMode==0&&((d=t.value)==null||d.scrollTo({top:t.value.scrollTop+(n.deltaY>0?Mt:-70),behavior:"smooth"}),n.preventDefault(),n.stopPropagation())}let K=0,Y=0,A=0,b=0;const L=Ke({onDown(n){return!c.value||!h.value?!1:(K=n.offsetX,Y=n.x-n.offsetX-h.value.offsetLeft,n.preventDefault(),R.value=!0,!0)},onMove(n,d,o){t.value&&c.value&&(q(o.x-K-Y),o.preventDefault(),o.stopPropagation())},onUp(){R.value=!1}}),X=Ke({onDown(n){return!m.value||!p.value?!1:(A=n.offsetY,b=n.y-n.offsetY-p.value.offsetTop,n.preventDefault(),R.value=!0,!0)},onMove(n,d,o){t.value&&m.value&&(te(o.y-A-b),o.preventDefault(),o.stopPropagation())},onUp(){R.value=!1}});function N(n){t.value&&(t.value.scrollLeft=n/100*(t.value.scrollWidth-t.value.offsetWidth))}function G(n){t.value&&(t.value.scrollLeft=n/100*(t.value.scrollHeight-t.value.offsetHeight))}function q(n){t.value&&(t.value.scrollLeft=n/(t.value.offsetWidth-C.sizeRaw)*(t.value.scrollWidth-t.value.offsetWidth))}function te(n){t.value&&(t.value.scrollTop=n/(t.value.offsetHeight-x.sizeRaw)*(t.value.scrollHeight-t.value.offsetHeight))}function I(n){r.scrollBarBackgroundClickable&&q(n.offsetX-C.sizeRaw/2)}function re(n){r.scrollBarBackgroundClickable&&te(n.offsetY-x.sizeRaw/2)}const{startResizeChecker:be,stopResizeChecker:s}=kt(t,()=>v(),()=>v());return xe(()=>{oe(()=>{setTimeout(()=>v(!0),200),v(!0),be(),P=new MutationObserver(()=>v()),P.observe(t.value,S)})}),ke(()=>{s(),P&&(P.disconnect(),P=null)}),l({refreshScrollState(){v(!0)},getScrollContainer(){return t.value},scrollTo(n,d){var o;(o=t.value)==null||o.scrollTo(n,d)},scrollToTop(){var n;(n=t.value)==null||n.scrollTo(0,0)},scrollToBottom(){var n;(n=t.value)==null||n.scrollTo(t.value.scrollWidth,t.value.scrollHeight)}}),(n,d)=>(y(),D("div",{ref_key:"scrollrect",ref:k,class:ae(["vue-scroll-rect",e.scrollBarAlwaysShow?"always-show-scrollbar":"",e.scrollBarBackgroundClickable?"background-clickable":"",R.value?"dragging":""]),style:ye({width:e.width?`${e.width}px`:void 0,height:e.height?`${e.height}px`:void 0}),onWheel:E},[U("div",{ref_key:"container",ref:t,class:ae(["scroll-content",e.scroll,e.containerClass]),style:ye({maxWidth:e.maxWidth?`${e.maxWidth}px`:void 0,maxHeight:e.maxHeight?`${e.maxHeight}px`:void 0,...e.containerStyle}),onScroll:i},[_(n.$slots,"default")],38),C.show?_(n.$slots,"scrollBarX",{key:0,scrollBarValue:C,onScroll:N},()=>[U("div",{ref_key:"scrollBarRefX",ref:c,class:"scrollbar horizontal",onClick:I,onWheel:w},[U("div",{class:"thumb",ref_key:"scrollBarThumbRefX",ref:h,style:ye({left:`${C.pos}%`,width:`${C.size}%`}),onMousedown:d[0]||(d[0]=(...o)=>u(L)&&u(L)(...o)),onWheel:w},null,36)],544)]):z("",!0),x.show?_(n.$slots,"scrollBarY",{key:1,scrollBarValue:x,onScroll:G},()=>[x.show?(y(),D("div",{key:0,ref_key:"scrollBarRefY",ref:m,class:"scrollbar vertical",onClick:re,onWheel:$},[U("div",{class:"thumb",ref_key:"scrollBarThumbRefY",ref:p,style:ye({top:`${x.pos}%`,height:`${x.size}%`}),onMousedown:d[1]||(d[1]=(...o)=>u(X)&&u(X)(...o)),onWheel:$},null,36)],544)):z("",!0)]):z("",!0)],38))}}),Re=(e,l)=>{const a=e.__vccOpts||e;for(const[r,f]of l)a[r]=f;return a},wt={},It={class:"mx-checked-mark","aria-hidden":"true",viewBox:"0 0 1024 1024"},Wt=U("path",{d:"M129.3,428.6L52,512l345,372.5l575-620.8l-69.5-75L400.4,718.2L129.3,428.6z"},null,-1),Ht=[Wt];function Rt(e,l){return y(),D("svg",It,Ht)}const Pt=Re(wt,[["render",Rt]]),Bt={},Ot={class:"mx-right-arrow","aria-hidden":"true",viewBox:"0 0 1024 1024"},Lt=U("path",{d:"M307.018 49.445c11.517 0 23.032 4.394 31.819 13.18L756.404 480.18c8.439 8.438 13.181 19.885 13.181 31.82s-4.741 23.38-13.181 31.82L338.838 961.376c-17.574 17.573-46.065 17.573-63.64-0.001-17.573-17.573-17.573-46.065 0.001-63.64L660.944 512 275.198 126.265c-17.574-17.573-17.574-46.066-0.001-63.64C283.985 53.839 295.501 49.445 307.018 49.445z"},null,-1),At=[Lt];function Ft(e,l){return y(),D("svg",Ot,At)}const Tt=Re(Bt,[["render",Ft]]),jt={class:"mx-item-row"},zt=["xlink:href"],$t={key:1,class:"label"},_t={class:"mx-item-row"},Et={class:"mx-shortcut"},Pe=le({__name:"ContextMenuItem",props:{disabled:{type:Boolean,default:!1},hidden:{type:Boolean,default:!1},customRender:{type:Function,default:null},customClass:{type:String,default:""},clickHandler:{type:Function,default:null},label:{type:[String,Object,Function],default:""},icon:{type:[String,Object,Function],default:""},iconFontClass:{type:String,default:"iconfont"},checked:{type:Boolean,default:!1},shortcut:{type:String,default:""},svgIcon:{type:String,default:""},svgProps:{type:Object,default:null},preserveIconWidth:{type:Boolean,default:!0},showRightArrow:{type:Boolean,default:!1},hasChildren:{type:Boolean,default:!1},clickClose:{type:Boolean,default:!0},clickableWhenHasChildren:{type:Boolean,default:!1},rawMenuItem:{type:Object,default:void 0}},emits:["click","subMenuOpen","subMenuClose"],setup(e,{expose:l,emit:a}){const r=e,f=a,{clickHandler:t,clickClose:k,clickableWhenHasChildren:c,disabled:m,hidden:h,label:p,icon:R,iconFontClass:V,showRightArrow:H,shortcut:C,hasChildren:x}=se(r),M=W(!1),g=W(!1),O=W(),B=j("globalOptions"),P=j("globalHasSlot"),S=j("globalRenderSlot"),i=j("globalCloseMenu"),v=j("menuContext"),E=We(()=>typeof p.value=="string"?p.value:typeof p.value=="function"?gt(p.value.toString()):"MenuItem[unknow]");Q("MenuItemName",E);const w={getSubMenuInstance:()=>{},showSubMenu:()=>M.value?(v.markActiveMenuItem(w,!0),!0):x.value?(K(),!0):!1,hideSubMenu:()=>{v.closeOtherSubMenu()},isDisabledOrHidden:()=>m.value||h.value,getElement:()=>O.value,focus:()=>g.value=!0,blur:()=>g.value=!1,click:$};Q("menuItemInstance",w),xe(()=>{v.isMenuItemDataCollectedFlag()?oe(()=>{let b=0;const L=v.getElement();if(L){let X=0;for(let N=0;N<L.children.length;N++){const G=L.children[N];if(G.getAttribute("data-type")==="ContextMenuItem"){if(G===O.value){b=X;break}X++}}}v.addChildMenuItem(w,b)}):v.addChildMenuItem(w)}),ke(()=>{v.removeChildMenuItem(w)});function $(b){if(!m.value){if(b){const L=b.target;if(L.classList.contains("mx-context-no-clickable")||B.value.ignoreClickClassName&&L.classList.contains(B.value.ignoreClickClassName))return;if(B.value.clickCloseClassName&&L.classList.contains(B.value.clickCloseClassName)){b.stopPropagation(),i(r.rawMenuItem);return}}x.value?c.value?(typeof t.value=="function"&&t.value(b),f("click",b)):M.value||K():(typeof t.value=="function"&&t.value(b),f("click",b),k.value&&i(r.rawMenuItem))}}function K(b){g.value=!1,v.checkCloseOtherSubMenuTimeOut()||v.closeOtherSubMenu(),m.value||(v.markActiveMenuItem(w),x.value&&(b||v.markThisOpenedByKeyBoard(),v.addOpenedSubMenu(Y),M.value=!0,oe(()=>f("subMenuOpen",w))))}function Y(){g.value=!1,M.value=!1,f("subMenuClose",w)}function A(){return{disabled:m.value,label:p.value,icon:R.value,iconFontClass:V.value,showRightArrow:H.value,clickClose:k.value,clickableWhenHasChildren:c.value,shortcut:C.value,theme:B.value.theme,isOpen:M,hasChildren:x,onClick:$,onMouseEnter:K,closeMenu:i}}return l(w),(b,L)=>u(h)?z("",!0):(y(),D("div",{key:0,class:"mx-context-menu-item-wrapper",ref_key:"menuItemRef",ref:O,"data-type":"ContextMenuItem"},[u(P)("itemRender")?(y(),T(u(J),{key:0,vnode:()=>u(S)("itemRender",A())},null,8,["vnode"])):e.customRender?(y(),T(u(J),{key:1,vnode:e.customRender,data:A()},null,8,["vnode","data"])):(y(),D("div",{key:2,class:ae(["mx-context-menu-item",u(m)?"disabled":"",g.value?"keyboard-focus":"",e.customClass?" "+e.customClass:"",M.value?"open":""]),onClick:$,onMouseenter:K},[_(b.$slots,"default",{},()=>[U("div",jt,[U("div",{class:ae(["mx-icon-placeholder",e.preserveIconWidth?"preserve-width":""])},[_(b.$slots,"icon",{},()=>[u(P)("itemIconRender")?(y(),T(u(J),{key:0,vnode:()=>u(S)("itemIconRender",A())},null,8,["vnode"])):typeof e.svgIcon=="string"&&e.svgIcon?(y(),D("svg",He({key:1,class:"icon svg"},e.svgProps),[U("use",{"xlink:href":e.svgIcon},null,8,zt)],16)):typeof u(R)!="string"?(y(),T(u(J),{key:2,vnode:u(R),data:u(R)},null,8,["vnode","data"])):typeof u(R)=="string"&&u(R)!==""?(y(),D("i",{key:3,class:ae(u(R)+" icon "+u(V)+" "+u(B).iconFontClass)},null,2)):z("",!0)]),e.checked?_(b.$slots,"check",{key:0},()=>[u(P)("itemCheckRender")?(y(),T(u(J),{key:0,vnode:()=>u(S)("itemCheckRender",A())},null,8,["vnode"])):z("",!0),ue(Pt)]):z("",!0)],2),_(b.$slots,"label",{},()=>[u(P)("itemLabelRender")?(y(),T(u(J),{key:0,vnode:()=>u(S)("itemLabelRender",A())},null,8,["vnode"])):typeof u(p)=="string"?(y(),D("span",$t,je(u(p)),1)):(y(),T(u(J),{key:2,vnode:u(p),data:u(p)},null,8,["vnode","data"]))])]),U("div",_t,[u(C)||b.$slots.shortcut?_(b.$slots,"shortcut",{key:0},()=>[u(P)("itemShortcutRender")?(y(),T(u(J),{key:0,vnode:()=>u(S)("itemShortcutRender",A())},null,8,["vnode"])):z("",!0),U("span",Et,je(u(C)),1)]):z("",!0),u(H)?_(b.$slots,"rightArrow",{key:1},()=>[u(P)("itemRightArrowRender")?(y(),T(u(J),{key:0,vnode:()=>u(S)("itemRightArrowRender",A())},null,8,["vnode"])):z("",!0),ue(Tt)]):z("",!0)])])],34)),_(b.$slots,"submenu",{context:w,show:M.value})],512))}}),Nt=le({name:"ContextMenuSperator",components:{VNodeRender:J},setup(){const e=j("globalHasSlot"),l=j("globalRenderSlot");return{globalHasSlot:e,globalRenderSlot:l}}}),Dt={key:1,class:"mx-context-menu-item-sperator mx-context-no-clickable"};function Vt(e,l,a,r,f,t){const k=et("VNodeRender");return e.globalHasSlot("separatorRender")?(y(),T(k,{key:0,vnode:()=>e.globalRenderSlot("separatorRender",{})},null,8,["vnode"])):(y(),D("div",Dt))}const ge=Re(Nt,[["render",Vt]]),Be=le({__name:"ContextSubMenu",props:{items:{type:Object,default:null},show:{type:Boolean,default:!1},maxHeight:{type:Number,default:0},maxWidth:{type:[String,Number],default:0},minWidth:{type:[String,Number],default:0},adjustPosition:{type:Boolean,default:!0},direction:{type:String,default:"br"},parentMenuItemContext:{type:Object,default:null}},emits:["closeAnimFinished"],setup(e,{expose:l,emit:a}){const r=e,f=a,t=W(!1),k=j("globalGetMenuHostId",""),c=j("menuContext"),m=j("globalOptions");j("globalHasSlot"),j("globalRenderSlot");const h=W("UnknowOrRoot"),p=j("MenuItemName",h),{zIndex:R,getParentWidth:V,getParentHeight:H,getZoom:C}=c,{adjustPosition:x}=se(r),M=W(),g=W(),O=W(),B=[],P=j("globalSetCurrentSubMenu"),S=[];let i=null,v=0;function E(){i&&i.blur()}function w(s,n){if(s){for(let d=n!==void 0?n:0;d<S.length;d++)if(!S[d].isDisabledOrHidden()){$(d);break}}else for(let d=n!==void 0?n:S.length-1;d>=0;d--)if(!S[d].isDisabledOrHidden()){$(d);break}}function $(s){if(i&&E(),s!==void 0&&(i=S[Math.max(0,Math.min(s,S.length-1))]),!i)return;i.focus();const n=i.getElement();n&&n.scrollIntoView({behavior:"auto",block:"nearest",inline:"nearest"})}function K(){P(Y)}const Y={el:O,name:p,isTopLevel:()=>c.getParentContext()===null,closeSelfAndActiveParent:()=>{const s=L.getParentContext();if(s){s.closeOtherSubMenu();const n=s.getSubMenuInstanceContext();if(n)return n.focusCurrentItem(),!0}return!1},closeCurrentSubMenu:()=>{var s;return(s=L.getParentContext())==null?void 0:s.closeOtherSubMenu()},moveCurrentItemFirst:()=>w(!0),moveCurrentItemLast:()=>w(!1),moveCurrentItemDown:()=>w(!0,i?S.indexOf(i)+1:0),moveCurrentItemUp:()=>w(!1,i?S.indexOf(i)-1:0),focusCurrentItem:()=>$(),openCurrentItemSubMenu:()=>i?i==null?void 0:i.showSubMenu():!1,triggerCurrentItemClick:s=>i==null?void 0:i.click(s)};let A=!1,b=!1;const L={zIndex:R+1,container:c.container,adjustPadding:m.value.adjustPadding||ee.defaultAdjustPadding,getParentWidth:()=>{var s;return((s=O.value)==null?void 0:s.offsetWidth)||0},getParentHeight:()=>{var s;return((s=O.value)==null?void 0:s.offsetHeight)||0},getPositon:()=>[I.value.x,I.value.y],getZoom:()=>m.value.zoom||ee.defaultZoom,addOpenedSubMenu(s){B.push(s)},closeOtherSubMenu(){B.forEach(s=>s()),B.splice(0,B.length),P(Y)},checkCloseOtherSubMenuTimeOut(){return v?(clearTimeout(v),v=0,!0):!1},closeOtherSubMenuWithTimeOut(){v=setTimeout(()=>{v=0,this.closeOtherSubMenu()},200)},addChildMenuItem:(s,n)=>{n===void 0?S.push(s):S.splice(n,0,s)},removeChildMenuItem:s=>{S.splice(S.indexOf(s),1),s.getSubMenuInstance=()=>{}},markActiveMenuItem:(s,n=!1)=>{E(),i=s,n&&$()},markThisOpenedByKeyBoard:()=>{A=!0},isOpenedByKeyBoardFlag:()=>A?(A=!1,!0):!1,isMenuItemDataCollectedFlag:()=>b,getElement:()=>O.value||null,getParentContext:()=>c,getSubMenuInstanceContext:()=>Y};Q("menuContext",L);const X={getChildItem:s=>S[s],getMenuDimensions:()=>g.value?{width:g.value.offsetWidth,height:g.value.offsetHeight}:{width:0,height:0},getSubmenuRoot:()=>g.value,getMenu:()=>O.value,getScrollValue:()=>{var s,n;return((n=(s=M.value)==null?void 0:s.getScrollContainer())==null?void 0:n.scrollTop)||0},setScrollValue:s=>{var n;return(n=M.value)==null?void 0:n.scrollTo(0,s)},getScrollHeight:()=>G.value,adjustPosition:()=>{re()},getMaxHeight:()=>q.value,getPosition:()=>I.value,setPosition:(s,n)=>{I.value.x=s,I.value.y=n}},N=j("menuItemInstance",void 0);N&&(N.getSubMenuInstance=()=>X);const G=W(0),q=W(0),te=W(!1),I=W({x:0,y:0});function re(){oe(()=>{const s=O.value,n=g.value;if(s&&n&&M.value){const{container:d}=c,o=(V==null?void 0:V())??0,ie=(H==null?void 0:H())??0,Z=getComputedStyle(n),F=parseFloat(Z.paddingLeft),ce=parseFloat(Z.paddingTop),Me=ie>0?ce:0,ot=document.documentElement.scrollHeight/C(),ut=document.documentElement.scrollWidth/C(),at=Math.min(ut,d.offsetWidth),Oe=Math.min(ot,d.offsetHeight);let Se=pe(s,d),we=me(s,d);r.direction.includes("l")?I.value.x-=s.offsetWidth+F:r.direction.includes("r")?I.value.x+=o+F:(I.value.x+=o/2,I.value.x-=(s.offsetWidth+F)/2),r.direction.includes("t")?I.value.y-=(s.offsetHeight+ce*2)/C():r.direction.includes("b")?I.value.y-=ce/C():I.value.y-=(s.offsetHeight+ce)/2/C(),oe(()=>{var Le,Ae;Se=pe(s,d),we=me(s,d);const Fe=((Ae=(Le=M.value)==null?void 0:Le.getScrollContainer())==null?void 0:Ae.scrollHeight)||0,st=r.maxHeight;G.value=r.maxHeight?Math.min(Fe,r.maxHeight):Fe;const rt=Se+s.offsetWidth-at,Te=we+G.value+Me*2-Oe;if(te.value=Te>0,x.value&&rt>0){const de=o+s.offsetWidth-F,fe=Se;de>fe?I.value.x-=fe:I.value.x-=de}if(te.value){if(x.value){const de=Te,fe=we;de>fe?I.value.y-=fe-Me:I.value.y-=de-Me}q.value=Oe-(I.value.y+ce)}else q.value=st||0})}})}function be(){var s;const n=(s=r.parentMenuItemContext)==null?void 0:s.getElement();if(n){const d=pe(n,c.container),o=me(n,c.container);I.value.x=d,I.value.y=o}else{const[d,o]=c.getPositon();I.value.x=d,I.value.y=o}oe(()=>{var d;P(Y),(d=O.value)==null||d.focus({preventScroll:!0}),c.isOpenedByKeyBoardFlag()&&oe(()=>w(!0)),b=!0}),re()}return Je(()=>r.show,s=>{s&&be()}),xe(()=>{t.value=!0,r.show?be():re()}),ke(()=>{t.value=!1,N&&(N.getSubMenuInstance=()=>{})}),l(X),(s,n)=>{const d=et("ContextSubMenu",!0);return t.value?(y(),T(qe,{key:0,to:`#${u(k)}`},[ue(dt,He({appear:""},u(m).menuTransitionProps||{duration:10},{onAfterLeave:n[0]||(n[0]=o=>f("closeAnimFinished"))}),{default:he(()=>[e.show?(y(),D("div",He({key:0,ref_key:"submenuRoot",ref:g},s.$attrs,{class:["mx-context-menu",u(m).customClass?u(m).customClass:"",u(m).theme??""],style:{maxWidth:e.maxWidth?u(Ne)(e.maxWidth):`${u(ee).defaultMaxWidth}px`,minWidth:e.minWidth?u(Ne)(e.minWidth):`${u(ee).defaultMinWidth}px`,zIndex:u(R),left:`${I.value.x}px`,top:`${I.value.y}px`},"data-type":"ContextSubMenu",onClick:K}),[ue(u(St),{ref_key:"scrollRectRef",ref:M,scroll:"vertical",maxHeight:q.value,containerClass:"mx-context-menu-scroll"},{default:he(()=>[U("div",{class:ae(["mx-context-menu-items"]),ref_key:"menu",ref:O},[_(s.$slots,"default",{},()=>[(y(!0),D(ze,null,Qe(e.items,(o,ie)=>(y(),D(ze,{key:ie},[o.hidden!==!0&&o.divided==="up"?(y(),T(ge,{key:0})):z("",!0),o.hidden!==!0&&o.divided==="self"?(y(),T(ge,{key:1})):(y(),T(Pe,{key:2,clickHandler:o.onClick?Z=>o.onClick(Z):void 0,disabled:typeof o.disabled=="object"?o.disabled.value:o.disabled,hidden:typeof o.hidden=="object"?o.hidden.value:o.hidden,icon:o.icon,iconFontClass:o.iconFontClass,svgIcon:o.svgIcon,svgProps:o.svgProps,label:o.label,customRender:o.customRender,customClass:o.customClass,checked:typeof o.checked=="object"?o.checked.value:o.checked,shortcut:o.shortcut,clickClose:o.clickClose,clickableWhenHasChildren:o.clickableWhenHasChildren,preserveIconWidth:o.preserveIconWidth!==void 0?o.preserveIconWidth:u(m).preserveIconWidth,showRightArrow:o.children&&o.children.length>0,hasChildren:o.children&&o.children.length>0,rawMenuItem:o,onSubMenuOpen:Z=>{var F;return(F=o.onSubMenuOpen)==null?void 0:F.call(o,Z)},onSubMenuClose:Z=>{var F;return(F=o.onSubMenuClose)==null?void 0:F.call(o,Z)}},Ge({_:2},[o.children&&o.children.length>0?{name:"submenu",fn:he(({context:Z,show:F})=>[ue(d,{show:F,parentMenuItemContext:Z,items:o.children,maxWidth:o.maxWidth,minWidth:o.minWidth,maxHeight:o.maxHeight,adjustPosition:o.adjustSubMenuPosition!==void 0?o.adjustSubMenuPosition:u(m).adjustPosition,direction:o.direction!==void 0?o.direction:u(m).direction},null,8,["show","parentMenuItemContext","items","maxWidth","minWidth","maxHeight","adjustPosition","direction"])]),key:"0"}:void 0]),1032,["clickHandler","disabled","hidden","icon","iconFontClass","svgIcon","svgProps","label","customRender","customClass","checked","shortcut","clickClose","clickableWhenHasChildren","preserveIconWidth","showRightArrow","hasChildren","rawMenuItem","onSubMenuOpen","onSubMenuClose"])),o.hidden!==!0&&(o.divided==="down"||o.divided===!0)?(y(),T(ge,{key:3})):z("",!0)],64))),128))])],512)]),_:3},8,["maxHeight"])],16)):z("",!0)]),_:3},16)],8,["to"])):z("",!0)}}}),lt=le({__name:"ContextSubMenuWrapper",props:{options:{type:Object,default:null},show:{type:null,default:null},container:{type:Object,default:null},isFullScreenContainer:{type:Boolean,default:!0}},emits:["close","closeAnimFinished"],setup(e,{expose:l,emit:a}){const r=e,f=a,t=Xe(),k=W(),{options:c,show:m,container:h}=se(r);xe(()=>{m.value&&V()}),ke(()=>{M()}),Je(m,i=>{i?V():(Ee(p),M())});const p={closeMenu:H,isClosed:C,getMenuRef:()=>k.value,getMenuDimensions:()=>{var i;return((i=k.value)==null?void 0:i.getMenuDimensions())??{width:0,height:0}}};let R=!1;function V(){x(),vt(p)}function H(i){R=!0,f("close",i),c.value.menuTransitionProps||f("closeAnimFinished"),Ee(p)}function C(){return R}function x(){setTimeout(()=>{document.addEventListener("click",P,!0),document.addEventListener("contextmenu",P,!0),document.addEventListener("scroll",B,!0),!r.isFullScreenContainer&&h.value&&h.value.addEventListener("scroll",B,!0),c.value.keyboardControl!==!1&&document.addEventListener("keydown",O,!0)},50)}function M(){document.removeEventListener("contextmenu",P,!0),document.removeEventListener("click",P,!0),document.removeEventListener("scroll",B,!0),!r.isFullScreenContainer&&h.value&&h.value.removeEventListener("scroll",B,!0),c.value.keyboardControl!==!1&&document.removeEventListener("keydown",O,!0)}const g=W();Q("globalSetCurrentSubMenu",i=>g.value=i),Q("globalGetMenuHostId",h.value.id);function O(i){var v,E,w,$,K,Y,A,b,L,X,N,G,q;let te=!0;switch(i.key){case"Escape":{((v=g.value)==null?void 0:v.isTopLevel())===!1?(E=g.value)==null||E.closeCurrentSubMenu():H();break}case"ArrowDown":(w=g.value)==null||w.moveCurrentItemDown();break;case"ArrowUp":($=g.value)==null||$.moveCurrentItemUp();break;case"Home":(K=g.value)==null||K.moveCurrentItemFirst();break;case"End":(Y=g.value)==null||Y.moveCurrentItemLast();break;case"ArrowLeft":{(A=g.value)!=null&&A.closeSelfAndActiveParent()||(L=(b=c.value).onKeyFocusMoveLeft)==null||L.call(b);break}case"ArrowRight":(X=g.value)!=null&&X.openCurrentItemSubMenu()||(G=(N=c.value).onKeyFocusMoveRight)==null||G.call(N);break;case"Enter":(q=g.value)==null||q.triggerCurrentItemClick(i);break;default:te=!1;break}te&&g.value&&(i.stopPropagation(),i.preventDefault())}function B(i){c.value.closeWhenScroll!==!1&&S(i.target,null)}function P(i){S(i.target,i)}function S(i,v){for(var E,w;i;){if(i.classList&&i.classList.contains("mx-context-menu"))return;i=i.parentNode}v?c.value.clickCloseOnOutside!==!1?(M(),H()):(w=(E=c.value).onClickOnOutside)==null||w.call(E,v):(M(),H())}return Q("globalOptions",c),Q("globalCloseMenu",H),Q("globalIsFullScreenContainer",r.isFullScreenContainer),Q("globalHasSlot",i=>t[i]!==void 0),Q("globalRenderSlot",(i,v)=>_(t,i,{...v},()=>[Ce("span","Render slot failed")],!1)),Q("menuContext",{zIndex:c.value.zIndex||ee.defaultZindex,container:h.value,adjustPadding:{x:0,y:0},getZoom:()=>c.value.zoom||ee.defaultZoom,getParentWidth:()=>0,getParentHeight:()=>0,getPositon:()=>[c.value.x,c.value.y],closeOtherSubMenuWithTimeOut:()=>{},checkCloseOtherSubMenuTimeOut:()=>!1,addOpenedSubMenu:()=>{},closeOtherSubMenu:()=>{},getParentContext:()=>null,getSubMenuInstanceContext:()=>null,getElement:()=>null,addChildMenuItem:()=>{},removeChildMenuItem:()=>{},markActiveMenuItem:()=>{},markThisOpenedByKeyBoard:()=>{},isOpenedByKeyBoardFlag:()=>!1,isMenuItemDataCollectedFlag:()=>!1}),l(p),(i,v)=>(y(),T(Be,{ref_key:"submenuInstance",ref:k,show:u(m),items:u(c).items,adjustPosition:u(c).adjustPosition,maxWidth:u(c).maxWidth||u(ee).defaultMaxWidth,minWidth:u(c).minWidth||u(ee).defaultMinWidth,maxHeight:u(c).maxHeight,direction:u(c).direction||u(ee).defaultDirection,onCloseAnimFinished:v[0]||(v[0]=E=>f("closeAnimFinished"))},{default:he(()=>[_(i.$slots,"default")]),_:3},8,["show","items","adjustPosition","maxWidth","minWidth","maxHeight","direction"]))}}),Kt=le({__name:"ContextMenu",props:{options:{type:Object,default:null},show:{type:Boolean,default:!1}},emits:["update:show","close"],setup(e,{expose:l,emit:a}){const r=a,f=e,{options:t,show:k}=se(f),{isNew:c,container:m,eleId:h}=nt(t.value),p=W(null),R=Xe();function V(H){var C,x;r("update:show",!1),r("close"),(x=(C=t.value).onClose)==null||x.call(C,H)}return l({closeMenu:()=>r("update:show",!1),isClosed:()=>!k.value,getMenuRef:()=>{var H;return(H=p.value)==null?void 0:H.getMenuRef()},getMenuDimensions:()=>{var H;return((H=p.value)==null?void 0:H.getMenuDimensions())??{width:0,height:0}}}),(H,C)=>(y(),T(qe,{to:`#${u(h)}`},[ue(lt,{ref_key:"menuRef",ref:p,options:u(t),show:u(k),container:u(m),isFullScreenContainer:!u(c),onClose:V},Ge({_:2},[Qe(u(R),(x,M)=>({name:M,fn:he(g=>[_(H.$slots,M,it(ct(g)))])}))]),1032,["options","show","container","isFullScreenContainer"])],8,["to"]))}}),Yt=le({name:"ContextMenuGroup",props:{disabled:{type:Boolean,default:!1},hidden:{type:Boolean,default:!1},clickHandler:{type:Function,default:null},label:{type:String,default:""},icon:{type:String,default:""},iconFontClass:{type:String,default:"iconfont"},checked:{type:Boolean,default:!1},shortcut:{type:String,default:""},svgIcon:{type:String,default:""},svgProps:{type:Object,default:null},preserveIconWidth:{type:Boolean,default:!0},showRightArrow:{type:Boolean,default:!1},clickClose:{type:Boolean,default:!0},adjustSubMenuPosition:{type:Boolean,default:void 0},maxHeight:{type:[String,Number],default:0},maxWidth:{type:[String,Number],default:0},minWidth:{type:[String,Number],default:0}},setup(e,l){const a=j("globalOptions"),{adjustSubMenuPosition:r,maxWidth:f,minWidth:t,maxHeight:k}=se(e),c=typeof r.value<"u"?r.value:a.value.adjustPosition,m=W(),h=W();return l.expose({getSubMenuRef:()=>m.value,getMenuItemRef:()=>h.value}),()=>Ce(Pe,{...e,ref:h,showRightArrow:!0,maxWidth:void 0,minWidth:void 0,maxHeight:void 0,adjustSubMenuPosition:void 0,hasChildren:typeof l.slots.default!==void 0},l.slots.default?{submenu:p=>Ce(Be,{ref:m,show:p.show,maxWidth:f.value,minWidth:t.value,maxHeight:k.value,adjustPosition:c,parentMenuItemContext:p.context},{default:l.slots.default}),...bt(l.slots,"default")}:l.slots)}});function Zt(e,l,a,r){const f=W(!0),t=Ce(lt,{options:e,show:f,container:l,isFullScreenContainer:!a,onCloseAnimFinished:()=>{$e(null,l)},onClose:k=>{var c;(c=e.onClose)==null||c.call(e,k),f.value=!1}},r);return $e(t,l),t.component}function Ue(e,l){const a=nt(e);return Zt(e,a.container,a.isNew,l).exposed}const Xt={install(e){e.config.globalProperties.$contextmenu=Ue,e.component("ContextMenu",Kt),e.component("ContextMenuItem",Pe),e.component("ContextMenuGroup",Yt),e.component("ContextMenuSperator",ge),e.component("ContextMenuSeparator",ge),e.component("ContextSubMenu",Be)},showContextMenu(e,l){return Ue(e,l)},isAnyContextMenuOpen(){return ft()},closeContextMenu:tt,transformMenuPosition:ht};export{Xt as Q};
