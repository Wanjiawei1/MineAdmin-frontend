import{d as Y,i as ee,r as x,c as T,o as le,n as oe,a as ne,g as te,b as u,E as U,m as I,w as ae,v as re,e as D,F as se,f as B,h as b,j as _,k as ue,l as ie}from"./index-fEaXY3hb.js";import{Q as ve}from"./vue3-context-menu.es-D4W0JZaz.js";import{R as ce}from"./index.es-C-Uuv6dA.js";import{L as de}from"./index.es-Bz9W3ohK.js";import{o as me}from"./index.es-BdsWK5Is.js";import{u as pe}from"./useGlobal-BBZzDt4J.js";import"./__commonjsHelpers__-Cpj98o6Y.js";const fe={name:"HeroiconsMagnifyingGlass"},C=(r,s)=>{const d=r.__vccOpts||r;for(const[c,p]of s)d[c]=p;return d},he={xmlns:"http://www.w3.org/2000/svg",width:"1.2em",height:"1.2em",viewBox:"0 0 20 20"},ge=[_("path",{fill:"currentColor",fillRule:"evenodd",d:"M9 3.5a5.5 5.5 0 1 0 0 11a5.5 5.5 0 0 0 0-11M2 9a7 7 0 1 1 12.452 4.391l3.328 3.329a.75.75 0 1 1-1.06 1.06l-3.329-3.328A7 7 0 0 1 2 9",clipRule:"evenodd"},null,-1)],we=C(fe,[["render",function(r,s,d,c,p,h){return b(),B("svg",he,ge)}]]),xe={name:"CarbonZoomReset"},ye={xmlns:"http://www.w3.org/2000/svg",width:"1.2em",height:"1.2em",viewBox:"0 0 32 32"},Me=[_("path",{fill:"currentColor",d:"M22.448 21A10.86 10.86 0 0 0 25 14A10.99 10.99 0 0 0 6 6.466V2H4v8h8V8H7.332a8.977 8.977 0 1 1-2.1 8h-2.04A11.01 11.01 0 0 0 14 25a10.86 10.86 0 0 0 7-2.552L28.586 30L30 28.586Z"},null,-1)],Se=C(xe,[["render",function(r,s,d,c,p,h){return b(),B("svg",ye,Me)}]]),Be={name:"MaterialSymbolsKeyboardArrowUp"},be={xmlns:"http://www.w3.org/2000/svg",width:"1.3em",height:"1.3em",viewBox:"0 0 24 24"},_e=[_("path",{fill:"currentColor",d:"m12 10.8l-4.6 4.6L6 14l6-6l6 6l-1.4 1.4z"},null,-1)],Ce=C(Be,[["render",function(r,s,d,c,p,h){return b(),B("svg",be,_e)}]]),Oe={name:"MaterialSymbolsKeyboardArrowDown"},Pe={xmlns:"http://www.w3.org/2000/svg",width:"1.3em",height:"1.3em",viewBox:"0 0 24 24"},Ae=[_("path",{fill:"currentColor",d:"m12 15.4l-6-6L7.4 8l4.6 4.6L16.6 8L18 9.4z"},null,-1)],$e=C(Oe,[["render",function(r,s,d,c,p,h){return b(),B("svg",Pe,Ae)}]]),Q=Y({name:"MaSearch",props:{options:{type:Object,default:()=>({})},formOptions:{type:Object,default:()=>({})},searchItems:{type:Array,default:()=>[]}},emits:["search","reset","fold"],setup(r,{slots:s,attrs:d,emit:c,expose:p}){var h;const W=ee("MaSearchOptions"),j=x(!1),O=`_${Math.floor(1e5*Math.random()+2e4*Math.random()+5e3*Math.random())}`,E=te(),o=x(r.options),M=x(r.formOptions),i=x(r.searchItems),v=x(((h=o.value)==null?void 0:h.defaultValue)??{}),S=()=>{var e;return(e=E==null?void 0:E.proxy)==null?void 0:e.$refs[`maFormSearchRef${O}`]},N=()=>{delete v.value.__MaSearchAction,c("search",v.value)},P=()=>o.value.fold,A=()=>{o.value.fold=!o.value.fold;const e=o.value.foldRows;i.value.map((l,n)=>{var a;if(n>(e?e-1:1)&&l.prop!=="__MaSearchAction"){const t=typeof l.hide=="function"?(a=l==null?void 0:l.hide)==null?void 0:a.call(l):(l==null?void 0:l.hide)??!1;l.show=!t&&o.value.fold,i.value[n]=l}}),c("fold",o.value.fold)},Z=()=>{var e,l;const{text:n}=o.value,a=P()?((e=n==null?void 0:n.isFoldBtn)==null?void 0:e.call(n))??"折叠":((l=n==null?void 0:n.notFoldBtn)==null?void 0:l.call(n))??"展开",t=P()?u(Ce,null,null):u($e,null,null);return u(D("el-link"),{type:"primary",underline:"never",onClick:()=>A()},{default:()=>a,icon:()=>u("div",{className:"fold-icon"},[t])})},$=()=>{var e,l,n,a;const{text:t,foldButtonShow:X,searchBtnProps:q,resetBtnProps:J}=o.value;return u("div",{className:"mineadmin-list-search-action"},[((e=s.actions)==null?void 0:e.call(s))??u("div",{className:"search-actions"},[u("div",{className:"actions-first"},[(l=s.beforeActions)==null?void 0:l.call(s)]),u(U,I({type:"primary",plain:!0},q,{onClick:()=>N()}),{default:()=>{var m;return((m=t==null?void 0:t.searchBtn)==null?void 0:m.call(t))??"搜索"},icon:()=>u(we,null,null)}),u(U,I(J,{onClick:()=>{var m,H;return i.value.map((f,Le)=>{var K;const R=typeof f.prop=="function"?(K=f==null?void 0:f.prop)==null?void 0:K.call(f):f.prop??void 0;!(f!=null&&f.show)&&R&&R!=="__MaSearchAction"&&(v.value[R]=void 0)}),(H=(m=S())==null?void 0:m.getElFormRef())==null||H.resetFields(),delete v.value.__MaSearchAction,void c("reset",v.value)}}),{default:()=>{var m;return((m=t==null?void 0:t.resetBtn)==null?void 0:m.call(t))??"重置"},icon:()=>u(Se,null,null)}),u("div",{className:"actions-end"},[(n=s.afterActions)==null?void 0:n.call(s)])]),(X??!0)&&((a=i.value)==null?void 0:a.length)>2&&Z()])},g=T(()=>{const{cols:e}=o.value;switch(w.value){case"xl":return(e==null?void 0:e.xl)??4;case"lg":return(e==null?void 0:e.lg)??3;case"md":return(e==null?void 0:e.md)??2;case"sm":return(e==null?void 0:e.sm)??2;case"xs":return(e==null?void 0:e.xs)??1}});T(()=>({display:"grid",gridGap:"10px 0px",gridTemplateColumns:`repeat(${g.value}, minmax(0, 1fr))`}));const k=(e,l=1,n=0)=>{let a=l,t=n;return e?{gridColumnStart:g.value-a-t+1,gridColumnEnd:`span ${a+t}`,marginLeft:t!==0?`calc(((100% + 10px) / ${a+t}) * ${t})`:"unset"}:{gridColumn:`span ${a+t>g.value?g.value:a+t}/span ${a+t>g.value?g.value:a+t}`,marginLeft:t!==0?`calc(((100% + 10px) / ${a+t}) * ${t})`:"unset"}},y=()=>{var e;G("__MaSearchAction")||i.value.push({prop:"__MaSearchAction",render:()=>$}),i.value.map((l,n)=>{l.prop!=="__MaSearchAction"?(l.renderProps===void 0?l.renderProps={class:"mine-w-full"}:l.renderProps.class="mine-w-full",l.renderProps.onKeyup=a=>{(a==null?void 0:a.code)!=="Enter"&&(a==null?void 0:a.key)!=="Enter"||N()},l.cols===void 0?l.cols={style:k(!1,l==null?void 0:l.span,l==null?void 0:l.offset)}:l.cols.style=k(!1,l==null?void 0:l.span,l==null?void 0:l.offset)):(l.itemProps={labelWidth:"0px"},l.cols={style:k(!0,1)}),i.value[n]=l}),M.value.flex={style:{display:"grid"}},(e=S())==null||e.setItems(i.value)},F=()=>{var e;(e=S())==null||e.setOptions(M.value)},V=()=>{y(),F();const{show:e}=o.value,l=typeof e=="function"?e:()=>e!==!1;return u(se,null,[ae(u("div",{className:`mineadmin-list-search-panel sp-${O}`},[u(D("ma-form"),I({ref:`maFormSearchRef${O}`,modelValue:v.value,"onUpdate:modelValue":n=>v.value=n},d),{default:s!=null&&s.default?()=>{var n;return(n=s.default)==null?void 0:n.call(s)}:null})]),[[re,l()]])])},w=x(),L=()=>{let e=window.innerWidth;switch(!!e){case e<768:w.value="xs";break;case(e>=768&&e<992):w.value="sm";break;case(e>=992&&e<1200):w.value="md";break;case(e>=1200&&e<1920):w.value="lg";break;case e>=1920:w.value="xl"}};le(async()=>{var e;j.value=!0,o.value.fold=((e=o.value)==null?void 0:e.fold)??!1,await oe(()=>A()),L(),window.addEventListener("resize",L)}),ne(()=>{window.removeEventListener("resize",L)});const z=e=>{i.value=e,y()},G=e=>{var l;return((l=i.value.filter(n=>n.prop===e))==null?void 0:l[0])??null};return p({getMaFormRef:S,setSearchForm:e=>{v.value=e===null?{}:Object.assign(v.value,e)},getSearchForm:()=>(delete v.value.__MaSearchAction,v.value),foldToggle:A,getFold:P,setShowState:e=>o.value.show=e,getShowState:()=>{var e;return((e=o.value)==null?void 0:e.show)??!0},setOptions:e=>{o.value=Object.assign(o.value,e),y(),F()},getOptions:()=>o.value,setFormOptions:e=>{M.value=Object.assign(o.value,e),F()},getFormOptions:()=>M.value,setItems:z,getItems:()=>i.value,appendItem:e=>{i.value.push(e),y()},removeItem:e=>{z(i.value.filter(l=>l.prop!==e)),y()},getItemByProp:G,setSearchBtnProps:e=>{o.value.searchBtnProps=Object.assign(o.value.searchBtnProps??{},e),$()},setResetBtnProps:e=>{o.value.resetBtnProps=Object.assign(o.value.resetBtnProps??{},e),$()}}),()=>W.ssr?j.value&&V():V()}}),ke={install(r,s){r.component(Q.name,Q),r.provide("MaSearchOptions",s??{ssr:!1})}};function Fe(){return{table:{commonOptions:{},commonColumns:[],commonPagination:null},form:{commonOptions:{},commonItems:[]},search:{commonOptions:{},commonItems:[]}}}const Ge={name:"mine-core",setProvider(r){r.use(me),r.use(ce),r.use(ke),r.use(de,{ssr:!1,provider:{app:r,icon:ue(ie),contextMenu:ve.showContextMenu}}),r.config.globalProperties.$mineCore=Fe()},getProvider(){return pe().$mineCore}};export{Ge as default};
