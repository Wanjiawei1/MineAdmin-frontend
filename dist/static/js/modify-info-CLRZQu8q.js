import{d as M,r as a,B as P,X as v,e as p,aj as T,h as U,O as s,ag as c,b as i,j as R,ab as z,w as O,v as x,z as B,ah as N,ai as I,b2 as j}from"./index-fEaXY3hb.js";import{u}from"./useLocalTrans-BLiEMMr_.js";import D from"./password-form-Ex8Zviny.js";import H from"./userinfo-form--tlcYwRf.js";import{u as L}from"./useMessage-BpWl7_QK.js";import{u as W}from"./useTrans-BxQFVQVs.js";import"./__commonjsHelpers__-Cpj98o6Y.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const X={class:"my-5"},q=M({name:"UcModifyInfo",__name:"modify-info",setup(d,{expose:n}){const b=L(),o=a("userinfo"),f=a(!1),g=a(),_=a(),w=P(),h=W().globalTrans,V=v([{label:u("change.info"),value:"userinfo"},{label:u("change.password"),value:"password"}]),r=v({isOpen:!1});function k(){r.isOpen=!0}function y(t){f.value=!0;const e=l=>j().post("/admin/permission/update",l);t.type==="userinfo"&&e(t.form).then(()=>{b.success(h("crud.updateSuccess")),w.getUserInfo().nickname=t.form.nickname,w.getUserInfo().signed=t.form.signed,r.isOpen=!1}),t.type==="password"&&e(t.form).then(()=>{b.success(h("crud.updateSuccess")),r.isOpen=!1}),f.value=!1}return n({openModal:k}),(t,e)=>{const l=p("m-tabs"),C=p("m-button"),F=p("m-modal");return U(),T(F,{modelValue:s(r).isOpen,"onUpdate:modelValue":e[2]||(e[2]=m=>s(r).isOpen=m),title:s(u)(s(o)==="info"?"change.info":"change.password"),"content-class":"w-[450px] h-[380px]"},{footer:c(()=>[i(C,{type:"submit",class:I(["!bg-[rgb(var(--ui-primary))] !text-gray-1 !active-bg-[rgb(var(--ui-primary))] !hover-bg-[rgb(var(--ui-primary)/.75)]",{loading:s(f)}]),onClick:e[1]||(e[1]=()=>{s(o)==="userinfo"?s(g).submit():s(_).submit()})},{default:c(()=>[B(N(s(u)(s(o)==="userinfo"?"change.info":"change.password")),1)]),_:1},8,["class"])]),default:c(()=>[i(l,{modelValue:s(o),"onUpdate:modelValue":e[0]||(e[0]=m=>z(o)?o.value=m:null),options:s(V),class:"text-sm"},null,8,["modelValue","options"]),R("div",X,[O(i(H,{ref_key:"userinfoFormRef",ref:g,onSubmit:y},null,512),[[x,s(o)==="userinfo"]]),O(i(D,{ref_key:"passwordFormRef",ref:_,onSubmit:y},null,512),[[x,s(o)==="password"]])])]),_:1},8,["modelValue","title"])}}});function S(d){const n=d;n.__i18n=n.__i18n||[],n.__i18n.push({locale:"",resource:{en:{change:{info:{t:0,b:{t:2,i:[{t:3}],s:"Modify info"}},password:{t:0,b:{t:2,i:[{t:3}],s:"Modify password"}}},changeProfileOrPassword:{t:0,b:{t:2,i:[{t:3}],s:"Modify profile or password"}}},zh_CN:{change:{info:{t:0,b:{t:2,i:[{t:3}],s:"修改信息"}},password:{t:0,b:{t:2,i:[{t:3}],s:"修改密码"}}},changeProfileOrPassword:{t:0,b:{t:2,i:[{t:3}],s:"修改个人信息或密码"}}},zh_TW:{change:{info:{t:0,b:{t:2,i:[{t:3}],s:"修改資料"}},password:{t:0,b:{t:2,i:[{t:3}],s:"修改密碼"}}},changeProfileOrPassword:{t:0,b:{t:2,i:[{t:3}],s:"修改個人資料或密碼"}}}}})}typeof S=="function"&&S(q);export{q as default};
